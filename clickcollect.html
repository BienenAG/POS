<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Kassen-App</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
        }
        
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f7fa;
            color: #2c3e50;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .app {
            display: flex;
            height: 100%;
            max-width: 1400px;
            margin: 0 auto;
            flex-direction: column;
            background: #ffffff;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
        }
        
        @media (min-width: 768px) {
            .app {
                flex-direction: row;
            }
        }
        
        /* Product Panel Styles */
        .product-panel {
            flex: 1;
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            border-bottom: 1px solid #e8ecf1;
            overflow: hidden;
            position: relative;
            background: #fafbfc;
        }
        
        @media (min-width: 768px) {
            .product-panel {
                border-right: 1px solid #e8ecf1;
                border-bottom: none;
            }
        }
        
        .product-grid-container {
            flex-grow: 1;
            overflow: hidden;
            position: relative;
            margin-bottom: 1rem;
        }
        
        .product-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.9rem;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            padding-right: 0.5rem;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            touch-action: pan-y;
            cursor: grab;
        }
        
        .product-grid::-webkit-scrollbar {
            width: 6px;
        }
        
        .product-grid::-webkit-scrollbar-track {
            background: #f0f3f7;
            border-radius: 10px;
        }
        
        .product-grid::-webkit-scrollbar-thumb {
            background: #d0d8e0;
            border-radius: 10px;
        }
        
        .product-grid::-webkit-scrollbar-thumb:hover {
            background: #b8c1cc;
        }
        
        @media (min-width: 768px) {
            .product-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        .product-tile {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1.5px solid #e8ecf1;
            padding: 0.75rem 0.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            user-select: none;
            position: relative;
            overflow: hidden;
        }
        
        .product-tile::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.12;
            z-index: 0;
            transition: opacity 0.25s ease;
        }
        
        .product-tile:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-color: #d8dfe8;
        }
        
        .product-tile:hover::before {
            opacity: 0.22;
        }
        
        .product-tile:active {
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
        }
        
        .product-tile:active::before {
            opacity: 0.28;
        }
        
        .product-tile h4 {
            margin: 0 0 0.25rem 0;
            font-size: 0.95rem;
            font-weight: 600;
            color: #2c3e50;
            position: relative;
            z-index: 1;
            transition: color 0.25s ease;
        }
        
        .product-tile span {
            font-size: 0.9rem;
            font-weight: 700;
            color: #556b82;
            position: relative;
            z-index: 1;
            transition: color 0.25s ease;
        }
        
        .product-tile:hover h4,
        .product-tile:active h4 {
            color: #1a2a3a;
        }
        
        .product-tile:hover span,
        .product-tile:active span {
            color: #3a4a5a;
        }
        
        /* Page Controls */
        .page-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            gap: 1rem;
        }
        
        .page-indicator-dots {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            flex: 1;
        }
        
        .page-dot {
            width: 8px;
            height: 8px;
            background-color: #d0d8e0;
            border-radius: 50%;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .page-dot.active {
            background-color: #a8b8cc;
            width: 24px;
            border-radius: 4px;
        }
        
        .settings-button {
            background: linear-gradient(135deg, #e8f0f8 0%, #f0f5fa 100%);
            border: 1.5px solid #d8dfe8;
            padding: 0.65rem;
            cursor: pointer;
            color: #556b82;
            border-radius: 0.65rem;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .settings-button:hover {
            background: linear-gradient(135deg, #dfe8f0 0%, #e8eff8 100%);
            border-color: #c8cfd8;
            color: #2c3e50;
            transform: translateY(-1px);
        }
        
        .settings-button svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }
        
        .management-link {
            padding: 0.65rem 1rem;
            background: linear-gradient(135deg, #e8f5f0 0%, #f0faf7 100%);
            color: #2d7a6a;
            text-decoration: none;
            border: 1.5px solid #d0e5df;
            border-radius: 0.65rem;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
        }
        
        .management-link:hover {
            background: linear-gradient(135deg, #dceee8 0%, #e8f8f2 100%);
            border-color: #b8d5cc;
            transform: translateY(-1px);
        }
        
        /* Cart Panel Styles */
        .cart-panel {
            width: 100%;
            max-height: 50vh;
            padding: 1.25rem;
            background: #fafbfc;
            display: flex;
            flex-direction: column;
            border-top: 1px solid #e8ecf1;
        }
        
        @media (min-width: 768px) {
            .cart-panel {
                width: 380px;
                max-height: none;
                border-top: none;
            }
        }
        
        .cart-panel h2 {
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0 0 0.9rem 0;
            color: #2c3e50;
        }
        
        #cart-items {
            list-style: none;
            padding: 0;
            margin: 0 0 0.75rem 0;
            flex-grow: 1;
            overflow-y: auto;
        }
        
        #cart-items::-webkit-scrollbar {
            width: 5px;
        }
        
        #cart-items::-webkit-scrollbar-track {
            background: #f0f3f7;
            border-radius: 10px;
        }
        
        #cart-items::-webkit-scrollbar-thumb {
            background: #d0d8e0;
            border-radius: 10px;
        }
        
        .cart-item-wrapper {
            position: relative;
            overflow: hidden;
            border-radius: 0.65rem;
            margin-bottom: 0.5rem;
            touch-action: pan-y;
            --swipe-progress: 0;
        }
        
        .cart-item-wrapper::before {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ffb3b3 0%, #ffaaaa 100%);
            z-index: 1;
            opacity: calc(var(--swipe-progress) * 0.8);
            z-index: 0;
        }
        
        .cart-item-wrapper.swiping::before {
            opacity: 0.8;
        }
        
        .cart-item-wrapper.swiping .cart-item {
            color: #8b5a5a;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #ffffff;
            padding: 0.6rem 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            position: relative;
            z-index: 10;
            border-radius: 0.65rem;
            transform: translateX(calc(var(--swipe-progress) * -100px));
            transition: transform 0.1s linear;
            user-select: none;
        }
        
        .cart-item-content {
            flex-grow: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .cart-item-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            flex-grow: 1;
            padding-right: 0.5rem;
        }
        
        .cart-item-info h4 {
            margin: 0;
            font-size: 0.9rem;
            font-weight: 600;
            color: #2c3e50;
            line-height: 1.2;
        }
        
        .cart-item-info span {
            font-size: 0.8rem;
            font-weight: 500;
            color: #556b82;
            margin-top: 0.1rem;
        }
        
        .cart-item-quantity {
            font-size: 0.9rem;
            font-weight: 700;
            color: #2c3e50;
            width: 30px;
            text-align: center;
            cursor: pointer;
            padding: 0.2rem;
            border-radius: 4px;
            transition: background 0.2s ease;
        }
        
        .cart-item-quantity:hover {
            background: #f0f3f7;
        }
        
        .cart-item-price {
            font-size: 0.9rem;
            font-weight: 700;
            color: #2c3e50;
            width: 60px;
            text-align: right;
        }
        
        .cart-item-delete {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 0;
            opacity: calc(var(--swipe-progress) * 1);
            transition: opacity 0.1s linear;
        }
        
        .cart-item-delete i {
            transform: translateX(calc(var(--swipe-progress) * -20px));
            transition: transform 0.1s linear;
        }
        
        .cart-item-delete:active {
            background: #ff8888;
        }
        
        /* Summary Styles */
        #cart-summary {
            border-top: 1px solid #e8ecf1;
            padding-top: 0.75rem;
            margin-top: 0.5rem;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.4rem;
            font-size: 1rem;
            font-weight: 500;
            color: #556b82;
        }
        
        .summary-row.total {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2c3e50;
            margin-top: 0.75rem;
        }
        
        /* Cart Actions */
        .cart-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }
        
        .cart-actions button {
            flex: 1;
            padding: 1rem 0.5rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        #deposit-button {
            background: linear-gradient(135deg, #f5f9fc 0%, #e8ecf1 100%);
            color: #556b82;
        }
        
        #deposit-button:hover {
            background: linear-gradient(135deg, #e8ecf1 0%, #d0d8e0 100%);
            transform: translateY(-1px);
        }
        
        #checkout-button {
            background: linear-gradient(135deg, #4CAF50 0%, #43A047 100%);
            color: white;
        }
        
        #checkout-button:hover {
            background: linear-gradient(135deg, #43A047 0%, #388E3C 100%);
            transform: translateY(-1px);
        }
        
        /* Cart Header */
        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .cart-header-actions {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }
        
        .cart-id-display {
            text-align: center;
            margin-top: 0.5rem;
            padding: 0.6rem;
            background: linear-gradient(135deg, #f5f9fc 0%, #f0f5fa 100%);
            border-radius: 0.65rem;
            font-size: 0.9rem;
            color: #556b82;
        }
        
        .cart-id-display span {
            font-weight: 400;
        }
        
        .cart-id-display strong {
            font-weight: 700;
            color: #1d4a6a;
            display: block;
            font-size: 0.8rem;
            margin-top: 0.15rem;
        }
        
        /* HTML Structure */
    </style>
    <style>
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.25);
            backdrop-filter: blur(6px);
            -webkit-backdrop-filter: blur(6px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.2s ease;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        .modal-content, .product-edit-modal-content {
            background: #ffffff;
            border: 1.5px solid #e8ecf1;
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 480px;
            max-height: 90vh;
            position: relative;
            display: flex;
            flex-direction: column;
            animation: slideUp 0.3s ease;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .modal-header h3 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .modal-close {
            font-size: 1.8rem;
            font-weight: 300;
            cursor: pointer;
            border: none;
            background: linear-gradient(135deg, #f5f7fa 0%, #f0f3f7 100%);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            color: #7a8a9e;
            border: 1.5px solid #e8ecf1;
        }
        
        .modal-close:hover {
            background: linear-gradient(135deg, #e8ecf1 0%, #dfe5ec 100%);
            transform: rotate(90deg);
            color: #2c3e50;
        }
        
        /* Product Management Styles */
        .product-management-list {
            list-style: none;
            padding: 0;
            margin: 0;
            overflow-y: auto;
            flex-grow: 1;
            margin-bottom: 1rem;
        }
        
        .product-management-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid #f0f3f7;
        }
        
        .product-management-item:last-child {
            border-bottom: none;
        }
        
        .product-management-info {
            flex-grow: 1;
        }
        
        .product-management-info h4 {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .product-management-info span {
            font-size: 0.85rem;
            color: #556b82;
        }
        
        .product-management-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .product-management-actions button {
            padding: 0.5rem 0.75rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background 0.2s ease;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .edit-product-button {
            background: #e8f0f8;
            color: #556b82;
        }
        
        .edit-product-button:hover {
            background: #d0d8e0;
        }
        
        .delete-product-button {
            background: #f8e8e8;
            color: #c0392b;
        }
        
        .delete-product-button:hover {
            background: #f0d0d0;
        }
        
        .add-product-button {
            width: 100%;
            padding: 0.75rem;
            background: linear-gradient(135deg, #4CAF50 0%, #43A047 100%);
            color: white;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .add-product-button:hover {
            background: linear-gradient(135deg, #43A047 0%, #388E3C 100%);
            transform: translateY(-1px);
        }
        
        /* Product Edit Modal Styles */
        .product-edit-modal-content label {
            display: block;
            margin-top: 1rem;
            margin-bottom: 0.4rem;
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.9rem;
        }
        
        .product-edit-modal-content input[type="text"],
        .product-edit-modal-content input[type="number"] {
            width: 100%;
            padding: 0.75rem;
            border: 1.5px solid #e8ecf1;
            border-radius: 0.65rem;
            font-size: 1rem;
            transition: border-color 0.2s ease;
        }
        
        .product-edit-modal-content input:focus {
            border-color: #a8b8cc;
            outline: none;
        }
        
        .color-picker-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: border-color 0.2s ease;
        }
        
        .color-option.selected {
            border-color: #2c3e50;
            box-shadow: 0 0 0 2px white;
        }
        
        .save-product-button {
            width: 100%;
            padding: 0.75rem;
            margin-top: 1.5rem;
            background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
            color: white;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .save-product-button:hover {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            transform: translateY(-1px);
        }
        
        /* Deposit Modal Styles */
        .deposit-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
            margin-top: 1rem;
        }
        
        .deposit-grid button {
            padding: 1rem 0.5rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            background: linear-gradient(135deg, #f5f9fc 0%, #e8ecf1 100%);
            color: #556b82;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .deposit-grid button:hover {
            background: linear-gradient(135deg, #e8ecf1 0%, #d0d8e0 100%);
            transform: translateY(-1px);
        }
        
        #current-deposit-display {
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            padding: 1rem;
            background: #f0f3f7;
            border-radius: 0.75rem;
            margin-bottom: 1rem;
            color: #2c3e50;
        }
        
        .deposit-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }
        
        .deposit-actions button {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .deposit-actions .manual-input-button {
            background: linear-gradient(135deg, #f5f9fc 0%, #e8ecf1 100%);
            color: #556b82;
        }
        
        .deposit-actions .manual-input-button:hover {
            background: linear-gradient(135deg, #e8ecf1 0%, #d0d8e0 100%);
            transform: translateY(-1px);
        }
        
        .deposit-actions .reset {
            background: linear-gradient(135deg, #f8e8e8 0%, #f0d0d0 100%);
            color: #c0392b;
        }
        
        .deposit-actions .reset:hover {
            background: linear-gradient(135deg, #f0d0d0 0%, #e8b8b8 100%);
            transform: translateY(-1px);
        }
        
        /* Checkout Modal Styles */
        .checkout-summary {
            padding: 1rem;
            background: #f0f3f7;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
        }
        
        .checkout-summary .summary-row {
            margin-bottom: 0.75rem;
        }
        
        .checkout-summary .summary-row:last-child {
            margin-bottom: 0;
        }
        
        .checkout-summary h4 {
            margin: 0;
            font-size: 1rem;
            font-weight: 500;
            color: #556b82;
        }
        
        .checkout-summary span {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .checkout-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
        }
        
        .checkout-grid button {
            padding: 1rem 0.5rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            background: linear-gradient(135deg, #e8f0f8 0%, #f0f5fa 100%);
            color: #556b82;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .checkout-grid button:hover {
            background: linear-gradient(135deg, #dfe8f0 0%, #e8eff8 100%);
            transform: translateY(-1px);
        }
        
        .checkout-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }
        
        .checkout-actions button {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .checkout-actions .manual-input-button {
            background: linear-gradient(135deg, #f5f9fc 0%, #e8ecf1 100%);
            color: #556b82;
        }
        
        .checkout-actions .manual-input-button:hover {
            background: linear-gradient(135deg, #e8ecf1 0%, #d0d8e0 100%);
            transform: translateY(-1px);
        }
        
        .checkout-actions .reset {
            background: linear-gradient(135deg, #f8e8e8 0%, #f0d0d0 100%);
            color: #c0392b;
        }
        
        .checkout-actions .reset:hover {
            background: linear-gradient(135deg, #f0d0d0 0%, #e8b8b8 100%);
            transform: translateY(-1px);
        }
        
        .checkout-actions .finish {
            background: linear-gradient(135deg, #4CAF50 0%, #43A047 100%);
            color: white;
        }
        
        .checkout-actions .finish:hover {
            background: linear-gradient(135deg, #43A047 0%, #388E3C 100%);
            transform: translateY(-1px);
        }
        
        /* Numpad Modal Styles */
        .numpad-display {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            padding: 1rem;
            background: #f0f3f7;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            color: #2c3e50;
        }
        
        .numpad-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
        }
        
        .numpad-grid button {
            padding: 1.5rem 0.5rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            background: linear-gradient(135deg, #f5f9fc 0%, #e8ecf1 100%);
            color: #2c3e50;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .numpad-grid button:hover {
            background: linear-gradient(135deg, #e8ecf1 0%, #d0d8e0 100%);
            transform: translateY(-1px);
        }
        
        .numpad-grid button.enter {
            grid-column: span 3;
            background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
            color: white;
        }
        
        .numpad-grid button.enter:hover {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }
        
        /* Quantity Modal Styles */
        .quantity-modal-content {
            max-width: 300px;
        }
        
        .quantity-modal-content .numpad-grid {
            grid-template-columns: repeat(3, 1fr);
        }
        
        .quantity-modal-content .numpad-grid button.enter {
            grid-column: span 3;
        }
        
        .quantity-modal-content .numpad-display {
            font-size: 1.5rem;
        }
        
        /* Donation Styles */
        .donation-banner {
            background: linear-gradient(135deg, #f0f7ff 0%, #e8f0f8 100%);
            border: 1px solid #d0e0f0;
            border-radius: 0.75rem;
            padding: 0.75rem;
            margin-top: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .donation-banner span {
            color: #3498db;
        }
        
        .donation-banner button {
            background: #3498db;
            color: white;
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 0.5rem;
            font-size: 0.8rem;
            font-weight: 700;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .donation-banner button:hover {
            background: #2980b9;
        }
        
        .donation-modal-content {
            max-width: 350px;
        }
        
        .donation-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
            margin-top: 1rem;
        }
        
        .donation-options button {
            padding: 1rem 0.5rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            background: linear-gradient(135deg, #e8f0f8 0%, #f0f5fa 100%);
            color: #556b82;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .donation-options button:hover {
            background: linear-gradient(135deg, #dfe8f0 0%, #e8eff8 100%);
            transform: translateY(-1px);
        }
        
        .donation-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }
        
        .donation-actions button {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .donation-actions .manual-input-button {
            background: linear-gradient(135deg, #f5f9fc 0%, #e8ecf1 100%);
            color: #556b82;
        }
        
        .donation-actions .manual-input-button:hover {
            background: linear-gradient(135deg, #e8ecf1 0%, #d0d8e0 100%);
            transform: translateY(-1px);
        }
        
        .donation-actions .confirm-button {
            background: linear-gradient(135deg, #4CAF50 0%, #43A047 100%);
            color: white;
        }
        
        .donation-actions .confirm-button:hover {
            background: linear-gradient(135deg, #43A047 0%, #388E3C 100%);
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="product-panel">
            <div class="page-controls">
                <button class="settings-button" onclick="prevPage()">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="page-indicator-dots" id="page-indicator-dots">
                    <!-- Dots will be rendered here -->
                </div>
                <button class="settings-button" onclick="nextPage()">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <div class="product-grid-container">
                <div class="product-grid" id="product-grid">
                    <!-- Product tiles will be rendered here -->
                </div>
            </div>
        </div>

        <div class="cart-panel">
            <div class="cart-header">
                <div class="cart-id-display" style="text-align: left; padding: 0; background: none; font-size: 1.2rem; font-weight: 700; color: #2c3e50;">
                BienenAG
            </div>
            </div>

            <h2>Warenkorb</h2>
            <ul id="cart-items"></ul>
            <div id="cart-summary">
                <div class="summary-row">
                    <span>Zwischensumme:</span>
                    <span id="subtotal">0,00 €</span>
                </div>
                <div class="summary-row">
                    <span>Pfandrückgabe:</span>
                    <span id="deposit-return">0,00 €</span>
                </div>
                <div class="summary-row total">
                    <span>Gesamt:</span>
                    <span id="total">0,00 €</span>
                </div>
            </div>
            <div class="cart-actions">
                <button id="deposit-button" onclick="showDepositMenu()">Pfandrückgabe</button>
                
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="deposit-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Pfandrückgabe</h3>
                <button class="modal-close" onclick="closeDepositMenu()">×</button>
            </div>
            <div id="current-deposit-display">0 Gläser</div>
            <div class="deposit-grid">
                <button onclick="addQuickDeposit(1)">1 Glas</button>
                <button onclick="addQuickDeposit(2)">2 Gläser</button>
                <button onclick="addQuickDeposit(3)">3 Gläser</button>
                <button onclick="addQuickDeposit(4)">4 Gläser</button>
                <button onclick="addQuickDeposit(5)">5 Gläser</button>
                <button onclick="addQuickDeposit(6)">6 Gläser</button>
                <button onclick="addQuickDeposit(7)">7 Gläser</button>
                <button onclick="addQuickDeposit(8)">8 Gläser</button>
                <button onclick="addQuickDeposit(9)">9 Gläser</button>
            </div>
            <div class="deposit-actions">
                <button class="manual-input-button" onclick="showNumpad()"><i class="fas fa-keyboard"></i> Manuelle Eingabe</button>
                <button class="reset" onclick="resetTotalDeposit()"><i class="fas fa-redo"></i> Zurücksetzen</button>
            </div>
        </div>
    </div>



    <div id="numpad-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content quantity-modal-content">
            <div class="modal-header">
                <h3>Menge eingeben</h3>
                <button class="modal-close" onclick="closeNumpad()">×</button>
            </div>
            <div class="numpad-display" id="numpad-display">0</div>
            <div class="numpad-grid">
                <button onclick="numpadInput('1')">1</button>
                <button onclick="numpadInput('2')">2</button>
                <button onclick="numpadInput('3')">3</button>
                <button onclick="numpadInput('4')">4</button>
                <button onclick="numpadInput('5')">5</button>
                <button onclick="numpadInput('6')">6</button>
                <button onclick="numpadInput('7')">7</button>
                <button onclick="numpadInput('8')">8</button>
                <button onclick="numpadInput('9')">9</button>
                <button onclick="numpadInput('clear')">C</button>
                <button onclick="numpadInput('0')">0</button>
                <button onclick="numpadInput(',')">,</button>
                <button class="enter" onclick="confirmManualInput()">Enter</button>
            </div>
        </div>
    </div>

    <div id="quantity-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content quantity-modal-content">
            <div class="modal-header">
                <h3 id="quantity-modal-title">Menge ändern</h3>
                <button class="modal-close" onclick="closeQuantityModal()">×</button>
            </div>
            <div class="numpad-display" id="quantity-numpad-display">0</div>
            <div class="numpad-grid">
                <button onclick="quantityNumpadInput('1')">1</button>
                <button onclick="quantityNumpadInput('2')">2</button>
                <button onclick="quantityNumpadInput('3')">3</button>
                <button onclick="quantityNumpadInput('4')">4</button>
                <button onclick="quantityNumpadInput('5')">5</button>
                <button onclick="quantityNumpadInput('6')">6</button>
                <button onclick="quantityNumpadInput('7')">7</button>
                <button onclick="quantityNumpadInput('8')">8</button>
                <button onclick="quantityNumpadInput('9')">9</button>
                <button onclick="quantityNumpadInput('clear')">C</button>
                <button onclick="quantityNumpadInput('0')">0</button>
                <button onclick="quantityNumpadInput('backspace')"><i class="fas fa-backspace"></i></button>
                <button class="enter" onclick="confirmQuantityInput()">Speichern</button>
            </div>
        </div>
    </div>



    <script>
        // === Konstanten für die Farbauswahl und den Pfandwert ===
        const pastelColors = [
            '#FFA3B3', '#FFC896', '#FFFFD0', '#D0FFCC', '#9EDAE5',
            '#9DD4E8', '#DCDCF0', '#D0B0D8', '#FFFAAA'
        ];
        const DEPOSIT_VALUE = 1.00;

        // === Lokale Zustandsvariablen ===
        let products = [];
        let cart = [];
        let currentPage = 0;
        const itemsPerPage = 16;
        let depositReturn = 0;
        let manualInputType = '';
        let manualDepositInput = "";
        let receivedAmount = 0;
        let manualReceivedInput = "";
        let manualQuantityInput = "";
        let editingCartItemId = null;
        let editingProductId = null;
        let editingProductColor = pastelColors[0];
        
        // Warenkorb-ID, die von dieser Kassen-App verwendet wird
        let currentCashRegisterCartId = 'BienenAG';

        // Variablen für die Wischgeste
        let touchstartX = 0;
        let isSwiping = false;
        const swipeThreshold = 150;

        // Variablen für die Warenkorb-Wischgeste
        let cartTouchStartX = 0;
        let cartTouchStartY = 0;
        let cartTouchStartTime = 0;
        let cartIsSwiping = false;
        let currentSwipingItem = null;
        const cartSwipeThreshold = 100;

        // === Initiale Anzeige beim Laden der Seite ===
        document.addEventListener('DOMContentLoaded', async () => {
            // Setze die Warenkorb-ID auf den gewünschten Text
            // Das Element mit der ID 'cart-id-display' wurde entfernt, daher ist dieser Teil nicht mehr nötig.
            // currentCashRegisterCartId bleibt 'BienenAG'

            await fetchProducts();
            // Beim Start den Warenkorb für diese Kassen-ID von der API laden
            await fetchCartFromApi(currentCashRegisterCartId); 
            
            renderCart();

            const productGrid = document.getElementById("product-grid");
            if(productGrid) {
                productGrid.addEventListener('touchstart', handleTouchStart, false);
                productGrid.addEventListener('touchmove', handleTouchMove, false);
                productGrid.addEventListener('touchend', handleTouchEnd, false);
            }
        });

        // === API-Logik zum Laden und Speichern der Produkte ===
        async function fetchProducts() {
            try {
                const response = await fetch(`${window.location.origin}/api/products`);
                if (!response.ok) {
                    throw new Error(`HTTP-Fehler! Status: ${response.status}`);
                }
                products = await response.json();
                renderProducts();
            } catch (error) {
                console.error("Fehler beim Laden der Produkte von der API.", error);
                // Fallback zu lokalen Produkten für Demo-Zwecke
                products = [
                    { id: 1, name: "Kaffee", price: 2.50, color: "#FFB6C1" },
                    { id: 2, name: "Tee", price: 2.00, color: "#FFDAB9" },
                    { id: 3, name: "Kuchen", price: 3.50, color: "#FFFFE0" },
                    { id: 4, name: "Sandwich", price: 4.00, color: "#E0FFDE" }
                ];
                renderProducts();
            }
        }

        async function saveProducts() {
            try {
                const response = await fetch(`${window.location.origin}/api/products`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(products),
                });
                if (!response.ok) {
                    throw new Error(`HTTP-Fehler! Status: ${response.status}`);
                }
                console.log("Produkte erfolgreich in der Datenbank gespeichert.");
            } catch (error) {
                console.error("Fehler beim Speichern der Produkte in der API.", error);
            }
        }
        
        // Funktion zum Speichern des Warenkorbs in der API (verwendet currentCashRegisterCartId)
        async function saveCartToApi(isCheckout = false, isFinished = false) {
            try {
                if (!currentCashRegisterCartId) {
                    console.error("Warenkorb-ID der Kasse fehlt. Kann nicht speichern.");
                    return;
                }

                // Zwischensumme und Gesamtbetrag direkt vor dem Senden berechnen
                let currentSubtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                let currentTotal = currentSubtotal - depositReturn;

                const response = await fetch(`${window.location.origin}/api/cart?cartId=${currentCashRegisterCartId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        cart: cart,
                        depositReturn: depositReturn,
                        receivedAmount: receivedAmount,
                        subtotal: currentSubtotal,
                        total: currentTotal,
                        isCheckout: isCheckout,
                        isFinished: isFinished
                    }),
                });
                if (!response.ok) {
                    throw new Error(`HTTP-Fehler! Status: ${response.status}`);
                }
                console.log("Warenkorb erfolgreich in der Datenbank gespeichert.");
            } catch (error) {
                console.error("Fehler beim Speichern des Warenkorbs in der API.", error);
            }
        }

        // Funktion zum Laden des Warenkorbs von der API
        async function fetchCartFromApi(cartId) {
            try {
                const response = await fetch(`${window.location.origin}/api/cart?cartId=${cartId}`);
                if (!response.ok) {
                    throw new Error(`HTTP-Fehler! Status: ${response.status}`);
                }
                const data = await response.json();
                if (data && data.cart) {
                    cart = data.cart;
                    depositReturn = data.depositReturn || 0;
                    receivedAmount = data.receivedAmount || 0;
                    renderCart();
                    console.log("Warenkorb erfolgreich von der API geladen.");
                }
            } catch (error) {
                console.error("Fehler beim Laden des Warenkorbs von der API.", error);
            }
        }

        // === Produkt-Logik ===
        function renderProducts() {
            const productGrid = document.getElementById('product-grid');
            if (!productGrid) return;

            const startIndex = currentPage * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const productsToRender = products.slice(startIndex, endIndex);

            productGrid.innerHTML = productsToRender.map(product => `
                <div class="product-tile" style="background: linear-gradient(135deg, ${product.color} 0%, #f8fafc 100%);" onclick="addToCart(${product.id})">
                    <h4>${product.name}</h4>
                    <span>${formatCurrency(product.price)}</span>
                </div>
            `).join('');

            renderPageDots();
        }

        function renderPageDots() {
            const pageDotsContainer = document.getElementById('page-indicator-dots');
            if (!pageDotsContainer) return;

            const totalPages = Math.ceil(products.length / itemsPerPage);
            pageDotsContainer.innerHTML = '';

            for (let i = 0; i < totalPages; i++) {
                const dot = document.createElement('div');
                dot.className = `page-dot ${i === currentPage ? 'active' : ''}`;
                dot.onclick = () => goToPage(i);
                pageDotsContainer.appendChild(dot);
            }
        }

        function goToPage(pageIndex) {
            const totalPages = Math.ceil(products.length / itemsPerPage);
            if (pageIndex >= 0 && pageIndex < totalPages) {
                currentPage = pageIndex;
                renderProducts();
            }
        }

        function nextPage() {
            const totalPages = Math.ceil(products.length / itemsPerPage);
            goToPage(currentPage + 1);
        }

        function prevPage() {
            goToPage(currentPage - 1);
        }

        // === Warenkorb-Logik ===
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const existingItem = cart.find(item => item.id === productId);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    quantity: 1,
                    color: product.color
                });
            }

            renderCart();
            saveCartToApi();
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            renderCart();
            saveCartToApi();
        }

        function updateCartItemQuantity(productId, newQuantity) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                const quantity = parseInt(newQuantity);
                if (quantity > 0) {
                    item.quantity = quantity;
                } else {
                    removeFromCart(productId);
                }
            }
            renderCart();
            saveCartToApi();
        }

        function renderCart() {
            const cartItemsContainer = document.getElementById('cart-items');
            const subtotalDisplay = document.getElementById('subtotal');
            const depositReturnDisplay = document.getElementById('deposit-return');
            const totalDisplay = document.getElementById('total');

            if (!cartItemsContainer || !subtotalDisplay || !depositReturnDisplay || !totalDisplay) return;

            let subtotal = 0;

            cartItemsContainer.innerHTML = cart.map(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;

                return `
                    <li class="cart-item-wrapper" data-id="${item.id}">
                        <div class="cart-item" style="border-left: 6px solid ${item.color};" 
                             ontouchstart="handleCartTouchStart(event)"
                             ontouchmove="handleCartTouchMove(event)"
                             ontouchend="handleCartTouchEnd(event)">
                            <div class="cart-item-content">
                                <div class="cart-item-info">
                                    <h4>${item.name}</h4>
                                    <span>${formatCurrency(item.price)} x ${item.quantity}</span>
                                </div>
                                <div class="cart-item-quantity" onclick="openQuantityModal(${item.id}, '${item.name}', ${item.quantity})">
                                    ${item.quantity}
                                </div>
                                <div class="cart-item-price">
                                    ${formatCurrency(itemTotal)}
                                </div>
                            </div>
                        </div>
                        <div class="cart-item-delete" onclick="removeFromCart(${item.id})">
                            <i class="fas fa-trash-alt"></i>
                        </div>
                    </li>
                `;
            }).join('');

            const total = subtotal - depositReturn;

            subtotalDisplay.textContent = formatCurrency(subtotal);
            depositReturnDisplay.textContent = formatCurrency(depositReturn);
            totalDisplay.textContent = formatCurrency(total);
        }

        // === Pfand-Logik ===
        function showDepositMenu() {
            document.getElementById('deposit-modal').style.display = 'flex';
            updateDepositDisplay();
        }

        function closeDepositMenu() {
            document.getElementById('deposit-modal').style.display = 'none';
            manualDepositInput = "";
            document.getElementById('numpad-display').textContent = '0';
        }

        function addQuickDeposit(count) {
            depositReturn += count * DEPOSIT_VALUE;
            updateDepositDisplay();
            saveCartToApi();
        }

        function resetTotalDeposit() {
            depositReturn = 0;
            updateDepositDisplay();
            saveCartToApi();
        }

        function updateDepositDisplay() {
            document.getElementById('current-deposit-display').textContent = `${(depositReturn / DEPOSIT_VALUE).toFixed(0)} Gläser (${formatCurrency(depositReturn)})`;
            renderCart();
        }

        // === Numpad-Logik ===
        function showNumpad() {
            manualInputType = 'deposit';
            const modal = document.getElementById('numpad-modal');
            const display = document.getElementById('numpad-display');
            const title = document.querySelector('#numpad-modal h3');

            title.textContent = 'Pfand eingeben (Gläser)';
            display.textContent = manualDepositInput || '0';

            modal.style.display = 'flex';
        }

        function closeNumpad() {
            document.getElementById('numpad-modal').style.display = 'none';
        }

        function numpadInput(key) {
            const display = document.getElementById('numpad-display');
            let currentInput = manualDepositInput;

            if (key === 'clear') {
                currentInput = '';
            } else {
                if (currentInput === '0' || currentInput === '') {
                    currentInput = key;
                } else {
                    currentInput += key;
                }
            }

            manualDepositInput = currentInput.replace(/[^0-9]/g, ''); // Nur Zahlen für Pfand
            display.textContent = manualDepositInput || '0';
        }

        function confirmManualInput() {
            const count = parseInt(manualDepositInput) || 0;
            depositReturn = count * DEPOSIT_VALUE;
            updateDepositDisplay();
            saveCartToApi();
            closeDepositMenu();
            closeNumpad();
        }

        // === Mengen-Modal-Logik ===
        function openQuantityModal(itemId, itemName, currentQuantity) {
            editingCartItemId = itemId;
            manualQuantityInput = currentQuantity.toString();
            
            document.getElementById('quantity-modal-title').textContent = `Menge für ${itemName}`;
            document.getElementById('quantity-numpad-display').textContent = manualQuantityInput;
            document.getElementById('quantity-modal').style.display = 'flex';
        }

        function closeQuantityModal() {
            document.getElementById('quantity-modal').style.display = 'none';
            editingCartItemId = null;
            manualQuantityInput = "";
        }

        function quantityNumpadInput(key) {
            const display = document.getElementById('quantity-numpad-display');
            let currentInput = manualQuantityInput;

            if (key === 'clear') {
                currentInput = '';
            } else if (key === 'backspace') {
                currentInput = currentInput.slice(0, -1);
            } else {
                if (currentInput === '0' || currentInput === '') {
                    currentInput = key;
                } else {
                    currentInput += key;
                }
            }
            
            manualQuantityInput = currentInput.replace(/[^0-9]/g, ''); // Nur Zahlen für Menge
            display.textContent = manualQuantityInput || '0';
        }

        function confirmQuantityInput() {
            const newQuantity = parseInt(manualQuantityInput) || 0;
            if (editingCartItemId !== null) {
                updateCartItemQuantity(editingCartItemId, newQuantity);
            }
            closeQuantityModal();
        }

        // === Hilfsfunktionen ===
        function formatCurrency(amount) {
            return new Intl.NumberFormat('de-DE', { style: 'currency', currency: 'EUR' }).format(amount);
        }

        // === Wischgesten-Logik für Produkt-Panel (wird beibehalten) ===
        function handleTouchStart(event) {
            touchstartX = event.touches[0].clientX;
            isSwiping = false;
        }

        function handleTouchMove(event) {
            if (isSwiping) return;
            const currentX = event.touches[0].clientX;
            const diffX = touchstartX - currentX;

            if (Math.abs(diffX) > 10) { // Start swiping if movement is significant
                isSwiping = true;
            }
        }

        function handleTouchEnd(event) {
            if (!isSwiping) return;

            const touchendX = event.changedTouches[0].clientX;
            const diffX = touchstartX - touchendX;

            if (diffX > swipeThreshold) {
                // Swipe left (next page)
                nextPage();
            } else if (diffX < -swipeThreshold) {
                // Swipe right (previous page)
                prevPage();
            }
            isSwiping = false;
        }

        // === Wischgesten-Logik für Warenkorb-Elemente (wird beibehalten) ===
        function handleCartTouchStart(event) {
            cartTouchStartX = event.touches[0].clientX;
            cartTouchStartY = event.touches[0].clientY;
            cartTouchStartTime = new Date().getTime();
            cartIsSwiping = false;
            currentSwipingItem = event.currentTarget.closest('.cart-item-wrapper');
            if (currentSwipingItem) {
                currentSwipingItem.classList.remove('swiping');
                currentSwipingItem.style.setProperty('--swipe-progress', '0');
            }
        }

        function handleCartTouchMove(event) {
            if (!currentSwipingItem) return;

            const currentX = event.touches[0].clientX;
            const currentY = event.touches[0].clientY;
            const diffX = cartTouchStartX - currentX;
            const diffY = cartTouchStartY - currentY;

            // Prevent vertical scrolling if horizontal swipe is dominant
            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 10) {
                event.preventDefault();
                cartIsSwiping = true;
                
                let progress = Math.min(1, Math.max(0, diffX / cartSwipeThreshold));
                currentSwipingItem.style.setProperty('--swipe-progress', progress.toString());
                currentSwipingItem.classList.add('swiping');
            } else if (Math.abs(diffY) > 10) {
                // Allow vertical scroll
                currentSwipingItem.style.setProperty('--swipe-progress', '0');
                currentSwipingItem.classList.remove('swiping');
                currentSwipingItem = null;
            }
        }

        function handleCartTouchEnd(event) {
            if (!currentSwipingItem || !cartIsSwiping) return;

            const touchendX = event.changedTouches[0].clientX;
            const diffX = cartTouchStartX - touchendX;
            const touchDuration = new Date().getTime() - cartTouchStartTime;

            if (diffX > cartSwipeThreshold || (diffX > 50 && touchDuration < 300)) {
                // Swipe left (show delete)
                currentSwipingItem.style.setProperty('--swipe-progress', '1');
            } else {
                // Snap back
                currentSwipingItem.style.setProperty('--swipe-progress', '0');
            }

            currentSwipingItem.classList.remove('swiping');
            cartIsSwiping = false;
            currentSwipingItem = null;
        }
    </script>
</body>
</html>
